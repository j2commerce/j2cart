if(void 0===j2store)var j2store={};if(void 0===j2store.jQuery&&(j2store.jQuery=jQuery.noConflict()),"undefined"==typeof J2Store&&(J2Store=jQuery.noConflict()),void 0===j2storeURL)var j2storeURL="";function removePAOption(t,a){!function(e){e.ajax({type:"post",url:j2storeURL+"administrator/index.php?option=com_j2store&view=products&task=removeProductOption",data:"pao_id="+t+"&product_type="+a,dataType:"json",success:function(a){a.success&&e("#pao_current_option_"+t).remove()}})}(j2store.jQuery)}function doAjaxPrice(t,a){!function(e){var o=e(a).closest("form");if(o.data("product_id")==t){console.log(j2storeURL);var n=o.serializeArray();if(n.pop({name:"task",value:"addOrderitems"}),n.pop({name:"view",value:"carts"}),n.push({name:"product_id",value:t}),s=n,e.each(s,function(t,a){("task"==a.name||"view"==a.name)&&delete n[t]}),"variable"==o.data("product_type")||"advancedvariable"==o.data("product_type")){var r=[];"advancedvariable"==o.data("product_type")?o.find("input[type='radio']:checked, select").each(function(t,a){a.value&&e(a).data("is-variant")&&r.push(a.value)}):o.find("input[type='radio']:checked, select").each(function(t,a){r.push(a.value)});var s,c=[],d=(c=r.sort(function(t,a){return t-a})).join(),p=get_matching_variant(o.data("product_variants"),d);o.find("input[name='variant_id']").val(p),n.push({name:"variant_id",value:p})}e.ajax({url:j2storeURL+"administrator/index.php?option=com_j2store&view=products&task=update&product_id="+t,type:"post",data:n,dataType:"json",success:function(a){console.log(a);var o=e(".product-"+t);o.length&&void 0===a.error&&(a.sku&&o.find(".sku").html(a.sku),a.pricing.base_price&&o.find(".base-price").html(a.pricing.base_price),a.pricing.price&&o.find(".sale-price").html(a.pricing.price),a.afterDisplayPrice&&o.find(".afterDisplayPrice").html(a.afterDisplayPrice),a.quantity&&o.find('input[name="product_qty"]').val(a.quantity),void 0!==a.stock_status&&(1==a.availability?o.find(".product-stock-container").html('<span class="instock">'+a.stock_status+"</span>"):o.find(".product-stock-container").html('<span class="outofstock">'+a.stock_status+"</span>")),a.dimensions&&o.find(".product-dimensions").html(a.dimensions),a.weight&&o.find(".product-weight").html(a.weight))},error:function(t,a,e){console.log(e+"\r\n"+t.statusText+"\r\n"+t.responseText)}})}}(j2store.jQuery)}function get_matching_variant(t,a){for(var e in t)if(t[e]==a)return e}function doAjaxFilter(t,a,e,o){!function(n){(""==t||0!=n("#ChildOptions"+e).length)&&n("#ChildOptions"+e).html("");var r=n(o).closest("form");if(r.data("product_id")==a){var s=r.serializeArray();if(s.pop({name:"task",value:"addOrderitems"}),s.pop({name:"view",value:"carts"}),s.push({name:"product_id",value:a}),d=s,n.each(d,function(t,a){("task"==a.name||"view"==a.name)&&delete s[t]}),"advancedvariable"==r.data("product_type")){var c=[];r.find("input[type='radio']:checked, select").each(function(t,a){a.value&&n(a).data("is-variant")&&c.push(a.value)});var d,p=[],u=(p=c.sort(function(t,a){return t-a})).join(),l=get_matching_variant(r.data("product_variants"),u);r.find("input[name='variant_id']").val(l),s.push({name:"variant_id",value:l})}s=jQuery.param(s),n.ajax({url:j2storeURL+"administrator/index.php?option=com_j2store&view=products&task=update&po_id="+e+"&pov_id="+t+"&product_id="+a,type:"get",cache:!1,data:s,dataType:"json",beforeSend:function(){n("#option-"+e).append('<span class="wait">&nbsp;<img src="'+j2storeURL+'/media/j2store/images/loader.gif" alt="" /></span>')},complete:function(){n(".wait").remove()},success:function(t){console.log(t);var o=n(".product-"+a);o.length&&void 0===t.error&&(t.sku&&o.find(".sku").html(t.sku),t.pricing.base_price&&o.find(".base-price").html(t.pricing.base_price),t.pricing.price&&o.find(".sale-price").html(t.pricing.price),t.afterDisplayPrice&&o.find(".afterDisplayPrice").html(t.afterDisplayPrice),t.quantity&&o.find('input[name="product_qty"]').val(t.quantity),t.dimensions&&o.find(".product-dimensions").html(t.dimensions),t.weight&&o.find(".product-weight").html(t.weight),void 0!==t.stock_status&&(1==t.availability?o.find(".product-stock-container").html('<span class="instock">'+t.stock_status+"</span>"):o.find(".product-stock-container").html('<span class="outofstock">'+t.stock_status+"</span>")),t.optionhtml&&o.find(" #ChildOptions"+e).html(t.optionhtml))},error:function(t,a,e){console.log(e+"\r\n"+t.statusText+"\r\n"+t.responseText)}})}}(j2store.jQuery)}function changeZone(t,a,e,o){t&&e&&function(n){n.ajax({url:j2storeURL+"index.php?option=com_j2store&view=carts&task=getCountry&country_id="+a,dataType:"json",beforeSend:function(){n("#"+t).after('<span class="wait">&nbsp;<img src="'+j2storeURL+'/media/j2store/images/loader.gif" alt="" /></span>')},complete:function(){n(".wait").remove()},success:function(t){let a='<option value="">--select--</option>';if(""!==t.zone)for(i=0,default_zone_id=o;i<t.zone.length;i++)a+='<option value="'+t.zone[i].j2store_zone_id+'"',t.zone[i].j2store_zone_id===default_zone_id&&(a+=' selected="selected"'),a+=">"+t.zone[i].zone_name+"</option>";else a+='<option value="0" selected="selected">None</option>';n("#"+e).html(a)},error:function(t,a,e){}})}(j2store.jQuery)}function listVariableItemTask(t,a,e){!function(o){o.ajax({url:j2storeURL+"administrator/index.php",dataType:"json",data:{option:"com_j2store",view:"products",task:"setDefaultVariant",v_id:t,status:a,product_id:e},success:function(t){t.success&&location.reload()}})}(j2store.jQuery)}function setExpandAll(){var t;(t=j2store.jQuery)('.j2store-product-variants .panel-collapse:not(".show")').collapse("show")}function setCloseAll(){var t;(t=j2store.jQuery)(".j2store-product-variants .panel-collapse.in").collapse("hide"),t(".j2store-product-variants .panel-collapse.show").collapse("hide")}function fancyConfirm(t){var a;t=(a=j2store.jQuery).extend(!0,{title:"Are you sure?",message:"",okButton:"OK",noButton:"Cancel",callback:a.noop},t||{}),a.fancybox.open({type:"html",src:'<div class="j2-content"><h3>'+t.title+"</h3><p>"+t.message+'</p><p class="tright"><a data-value="0" data-fancybox-close class="btn btn-danger">'+t.noButton+'</a><button data-value="1" data-fancybox-close class="btn btn-primary">'+t.okButton+"</button></p></div>",opts:{animationDuration:350,animationEffect:"material",modal:!0,baseTpl:'<div class="fancybox-container fc-container" role="dialog" tabindex="-1"><div class="fancybox-bg"></div><div class="fancybox-inner"><div class="fancybox-stage"></div></div></div>',afterClose:function(e,o,n){var r=n?n.target||n.currentTarget:null,s=r?a(r).data("value"):0;t.callback(s)}}})}!function(t){t(document).on("click",".j2store-cart-button",function(a){a.preventDefault(),t(".j2store-cart-button");var e=t(".j2store-addtocart-form");e.find("input[name='ajax']").val(1);var o=t(".j2store-addtocart-form").serializeArray(),n=t("#user_id").val(),r=t("#oid").val(),s=t("#product_id").val();e.find("input[type='submit']").val(e.find("input[type='submit']").data("cart-action-always"));var c={option:"com_j2store",view:"carts",task:"addOrderitems",ajax:"1",user_id:n,oid:r,product_id:s};t.each(o,function(t,a){a.name in c||!a.value||(c[a.name]=a.value)}),t.ajax({type:"post",url:j2storeURL+"administrator/index.php",data:c,dataType:"json",success:function(a){if(t(".j2success, .j2warning, .j2attention, .j2information, .j2error").remove(),e.find("input[type='submit']").val(e.find("input[type='submit']").data("cart-action-done")),a.success&&t(".j2store-product").before('<div class="alert alert-success j2success">'+a.message+"</div>"),a.error&&a.error.option)for(i in a.error.option)e.find("#option-"+i).after('<span class="j2error">'+a.error.option[i]+"</span>")},error:function(t,a,e){}})})}(j2store.jQuery),function(t){t(document).on("click",".j2store-product-variants .launchConfirm",function(a){let e=t(this).data("confirm_type"),o=t(this).data("product_id"),n=t(this).data("disable_msg"),r=t(this).data("title"),s=t(this).data("message"),c=t(this).data("yes_text"),d=t(this).data("no_text");"generateVariants"===e?(t(this).attr("disabled",!0),t(this).attr("value",n),t.ajax({type:"post",url:j2storeURL+"administrator/index.php",cache:!1,dataType:"json",data:{option:"com_j2store",view:"products",task:e,product_id:o}}).done(function(t){location.reload(!0)})):fancyConfirm({title:r,message:s,okButton:c,noButton:d,callback:function(a){a&&(t(this).attr("disabled",!0),t(this).attr("value",n),t.ajax({type:"post",url:j2storeURL+"administrator/index.php",cache:!1,dataType:"json",data:{option:"com_j2store",view:"products",task:e,product_id:o}}).done(function(t){location.reload(!0)}))}})})}(j2store.jQuery);
